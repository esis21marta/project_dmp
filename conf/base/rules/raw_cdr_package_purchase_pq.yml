raw_cdr_package_purchase_pq:
  rules:
  - schema:
      load_ts: TimestampType
      load_user: StringType
      msisdn: IntegerType
      rev_data_pkg_prchs: DoubleType
      rev_pkg_prchse: DoubleType
      rev_roam_pkg_prchs: DoubleType
      rev_sms_pkg_prchs: DoubleType
      rev_voice_pkg_prchs: DoubleType
      rev_voice_pkg_talkmania: DoubleType
      trx_data_pkg_prchs: LongType
      trx_data_pkg_prchs_day: LongType
      trx_data_pkg_prchs_night: LongType
      trx_date: TimestampType
      trx_pkg_prchse: LongType
      trx_roam_pkg_prchs: LongType
      trx_roam_pkg_prchs_day: LongType
      trx_roam_pkg_prchs_night: LongType
      trx_sms_pkg_prchs: LongType
      trx_sms_pkg_prchs_day: LongType
      trx_sms_pkg_prchs_night: LongType
      trx_voice_pkg_prchs: LongType
      trx_voice_pkg_prchs_day: LongType
      trx_voice_pkg_prchs_night: LongType
      yearmonth: IntegerType
    type: defender.pyspark_rules.HasSchema
  - columns:
    - trx_date
    - msisdn
    type: defender.pyspark_rules.NotNull
  - columns:
    - msisdn
    - yearmonth
    - trx_pkg_prchse
    - rev_pkg_prchse
    - trx_voice_pkg_prchs
    - trx_sms_pkg_prchs
    - trx_data_pkg_prchs
    - trx_roam_pkg_prchs
    - rev_voice_pkg_prchs
    - rev_sms_pkg_prchs
    - rev_data_pkg_prchs
    - rev_roam_pkg_prchs
    - trx_voice_pkg_prchs_day
    - trx_sms_pkg_prchs_day
    - trx_data_pkg_prchs_day
    - trx_roam_pkg_prchs_day
    - trx_voice_pkg_prchs_night
    - trx_sms_pkg_prchs_night
    - trx_data_pkg_prchs_night
    - trx_roam_pkg_prchs_night
    - rev_voice_pkg_talkmania
    type: defender.pyspark_rules.NotNan
  type: and
