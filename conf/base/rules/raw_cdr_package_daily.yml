raw_cdr_package_daily:
  rules:
  - schema:
      data_roam_kb_pkg: LongType
      dur_voice_day_pkg: LongType
      dur_voice_idd_pkg: LongType
      dur_voice_night_pkg: LongType
      dur_voice_onnet_pkg: LongType
      dur_voice_pkg: LongType
      load_ts: TimestampType
      load_user: StringType
      msisdn: IntegerType
      trx_data_pkg: LongType
      trx_date: TimestampType
      trx_dls_pkg: LongType
      trx_others_pkg: LongType
      trx_roam_sms_pkg: LongType
      trx_roam_voice_i_pkg: LongType
      trx_roam_voice_o_pkg: LongType
      trx_roam_voice_pkg: LongType
      trx_roaming_pkg: LongType
      trx_sms_day_pkg: LongType
      trx_sms_night_pkg: LongType
      trx_sms_onnet_pkg: LongType
      trx_sms_pkg: LongType
      trx_total_pkg: LongType
      trx_voice_day_pkg: LongType
      trx_voice_idd_pkg: LongType
      trx_voice_night_pkg: LongType
      trx_voice_onnet_pkg: LongType
      trx_voice_pkg: LongType
      vol_data_day_kb_pkg: LongType
      vol_data_kb_pkg: LongType
      vol_data_night_kb_pkg: LongType
      yearmonth: IntegerType
    type: defender.pyspark_rules.HasSchema
  - columns:
    - trx_date
    - msisdn
    type: defender.pyspark_rules.NotNull
  - columns:
    - msisdn
    - yearmonth
    - trx_total_pkg
    - trx_voice_pkg
    - trx_sms_pkg
    - trx_data_pkg
    - trx_roaming_pkg
    - trx_dls_pkg
    - trx_others_pkg
    - trx_voice_onnet_pkg
    - trx_sms_onnet_pkg
    - trx_voice_idd_pkg
    - dur_voice_pkg
    - dur_voice_idd_pkg
    - dur_voice_onnet_pkg
    - vol_data_kb_pkg
    - trx_voice_day_pkg
    - dur_voice_day_pkg
    - trx_sms_day_pkg
    - vol_data_day_kb_pkg
    - trx_voice_night_pkg
    - dur_voice_night_pkg
    - trx_sms_night_pkg
    - vol_data_night_kb_pkg
    - data_roam_kb_pkg
    - trx_roam_sms_pkg
    - trx_roam_voice_o_pkg
    - trx_roam_voice_i_pkg
    - trx_roam_voice_pkg
    type: defender.pyspark_rules.NotNan
  type: and
